import{aj as t}from"./vendor.js";class o{constructor(o){this.config=t(o,{host:"127.0.0.1",port:8888,protocol:"ws",onClose:void 0,onMessage:void 0,onOpen:void 0}),this.ws=void 0,this.tryConnectWaitTimeBase=500,this.tryConnectWaittime=500,this.tryConnect=this.tryConnect.bind(this),this.tryConnect()}tryConnect(){var{host:t,port:o,protocol:s,onClose:n,onMessage:e,onOpen:i}=this.config;if(!this.ws)try{var c="".concat(s,"://").concat(t,":").concat(o);console.log("connecting ws to",c),this.ws=new WebSocket(c),i&&(this.ws.onopen=i),e&&(this.ws.onmessage=e),n&&(this.ws.onclose=n)}catch(t){this.ws=void 0,console.error("Error connecting to websocket server:",t,"retrying in","".concat(this.tryConnectWaittime,"ms")),setTimeout(tryConnect,this.tryConnectWaittime),this.tryConnectWaittime+=this.tryConnectWaitTimeBase}}send(t){console.log("WS relays msg:",t),this.ws.send(t)}close(){var t;null===(t=this.ws)||void 0===t||t.close()}}export{o as WS};
