import{c as e,$ as t}from"../vendor.js";class i{constructor(e){var{artifact:t,mergeConfig:i}=e;this.artifact=t,this.config=i(t,{apiHost:"localhost:2351"}),this.hasVoted=!1}afterLoadModel(e){var{engine:t,preload:i}=e;this.engine=t,this.preload=i,this.gChar=t.model.getObjectByName("cyborg_gameover"),this.rChar=t.model.getObjectByName("cyborg_replay"),this.bunny=t.model.getObjectByName("bunny"),this.bunny.visible=!1}afterVote(t){var i=this;return e((function*(){if(i.hasVoted=!0,i.vote=t,0===i.vote){i.engine.actions.find((e=>"clippDoor_opens"===e._clip.name)).paused=!1;var e=i.engine.actions.find((e=>"landing"===e._clip.name));e.paused=!1}else if(1===i.vote){i.bunny.visible=!0;var n=i.engine.actions.find((e=>"location"===e._clip.name));n.paused=!1;var o=i.engine.actions.find((e=>"shapekeys"===e._clip.name));o.paused=!1}}))()}distanceMatch(e){var{distance:i,config:n,node:o}=e,{min:a=0,max:s}=n.distance;i<=s&&i>=a?this.trackedNode||(this.trackedNode=o,this.voteButton&&t.remove(this.voteButton),this.hasVoted||(this.voteButton=t.create("button",{id:o.name.split("_")[0],on:{click:e=>{var i="gameover"===e.target.id?0:1;t.create("img",{src:"http://".concat(this.config.apiHost,"/v1/vote?").concat(i),parent:document.body,on:{error:e=>{t.remove(e.target),t.remove(this.voteButton),this.afterVote(i)}}})}},innerText:"Vote for ".concat(o.name.split("_")[0]),parent:this.engine.hud.gui}))):this.trackedNode&&o.name===this.trackedNode.name&&(this.trackedNode=null,t.remove(this.voteButton),this.voteButton=null)}tick(){this.engine.modelSpawned}}export{i as default};
