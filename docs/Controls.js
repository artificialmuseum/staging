import{bf as e,bg as i,ae as t,bh as c,c as a}from"./vendor.js";var r,l=new WeakSet;class s{constructor(c){var{clickables:a,clickableChildren:r=!1,engine:s}=c;e(this,l),this.clickables=a,this.clickNodes=a.map((e=>e.node)),this.clickableChildren=r,this.engine=s,this.rotationMatrix=new i,this.raycaster=new t,this.click=this.click.bind(this),this.select=this.select.bind(this)}click(e){var{clickables:i,clickableChildren:t,clickNodes:a}=this;if(!0===i)c(this,l,n).call(this);else{var{raycaster:r}=this,{camera:s,renderer:o}=this.engine,h=e.clientX/o.domElement.clientWidth*2-1,d=-e.clientY/o.domElement.clientHeight*2+1;r.setFromCamera({x:h,y:d},s);var b=r.intersectObjects(a,t);c(this,l,n).call(this,b)}}select(){var e=this;return a((function*(){var{clickables:i,clickableChildren:t,clickNodes:a}=e;if(!0===i)yield c(e,l,n).call(e);else{var{raycaster:r,rotationMatrix:s}=e,{controller:o}=e.engine;s.extractRotation(o.matrixWorld),r.ray.origin.setFromMatrixPosition(o.matrixWorld),r.ray.direction.set(0,0,-1).applyMatrix4(s);var h=r.intersectObjects(a,t);yield c(e,l,n).call(e,h)}}))()}}function n(){return(r=r||a((function*(){var e=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((i=>{var{object:t}=i,c=this.clickables.find((e=>e.node.name===t.name));c&&e.push(c)})),yield this.engine.onTouch(e),e}))).apply(this,arguments)}export{s as Controls};
