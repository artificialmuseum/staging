import{bb as e,ae as i,c as t}from"./vendor.js";class r{constructor(t){var{clickables:r,clickableChildren:a=!1,engine:n}=t;this.clickables=r,this.clickNodes=r.map((e=>e.node)),this.clickableChildren=a,this.engine=n,this.rotationMatrix=new e,this.raycaster=new i,this.click=this.click.bind(this),this.select=this.select.bind(this)}click(e){var{clickables:i,clickableChildren:t,clickNodes:r}=this;if(!0===i)this.handle();else{var{raycaster:a}=this,{camera:n,renderer:c}=this.engine,l=e.clientX/c.domElement.clientWidth*2-1,s=-e.clientY/c.domElement.clientHeight*2+1;a.setFromCamera({x:l,y:s},n);var o=a.intersectObjects(r,t).filter((e=>e));this.handle(o)}}select(){var e=this;return t((function*(){var{clickables:i,clickNodes:t}=e;if(!0===i)yield e.handle();else{var{raycaster:r,rotationMatrix:a}=e,{controller:n}=e.engine;a.extractRotation(n.matrixWorld),r.ray.origin.setFromMatrixPosition(n.matrixWorld),r.ray.direction.set(0,0,-1).applyMatrix4(a);var c=r.intersectObjects(t,!0);yield e.handle(c)}}))()}handle(){var e=arguments,i=this;return t((function*(){var t=(e.length>0&&void 0!==e[0]?e[0]:[]).map((e=>{var{object:t}=e;return[t.name,i.clickables.find((e=>e.node.name===t.name))]})),r=Object.fromEntries(t),a=Object.values(r);return yield i.engine.onTouch(a),a}))()}}export{r as Controls};
