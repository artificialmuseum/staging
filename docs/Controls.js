import{bc as i,bi as e,ae as t,bg as c,c as r}from"./vendor.js";var a=new WeakSet;class l{constructor(c){var{clickables:r,clickableChildren:l=!1,engine:s}=c;i(this,a),this.clickables=r,this.clickNodes=r.map((i=>i.node)),this.clickableChildren=l,this.engine=s,this.rotationMatrix=new e,this.raycaster=new t,this.click=this.click.bind(this),this.select=this.select.bind(this)}click(i){var{clickables:e,clickableChildren:t,clickNodes:r}=this;if(!0===e)c(this,a,s).call(this);else{var{raycaster:l}=this,{camera:n,renderer:o}=this.engine,h=i.clientX/o.domElement.clientWidth*2-1,d=-i.clientY/o.domElement.clientHeight*2+1;l.setFromCamera({x:h,y:d},n);var b=l.intersectObjects(r,t);c(this,a,s).call(this,b)}}select(){var i=this;return r((function*(){var{clickables:e,clickableChildren:t,clickNodes:r}=i;if(!0===e)yield c(i,a,s).call(i);else{var{raycaster:l,rotationMatrix:n}=i,{controller:o}=i.engine;n.extractRotation(o.matrixWorld),l.ray.origin.setFromMatrixPosition(o.matrixWorld),l.ray.direction.set(0,0,-1).applyMatrix4(n);var h=l.intersectObjects(r,t);yield c(i,a,s).call(i,h)}}))()}}function s(){return n.apply(this,arguments)}function n(){return n=r((function*(){var i=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((e=>{var{object:t}=e,c=this.clickables.find((i=>i.node.name===t.name));c&&i.push(c)})),yield this.engine.onTouch(i),i})),n.apply(this,arguments)}export{l as Controls};
